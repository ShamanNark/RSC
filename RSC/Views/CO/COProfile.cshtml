@model RSC.Controllers.Models.CoProfileViewModels.CoProfileViewModel
@{
    ViewData["Title"] = "Личный кабинет СО";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<link rel="stylesheet" href="~/pg-calendar-master/dist/css/pignose.calendar.min.css" />
<style>
    .pignose-calendar {
        width: 100%;
        max-width: 600px;
        border:none;
        box-shadow: none;
    }


    .infobycalendar {
        width: 320px;
        left: 50%;
        margin-left: -60px;
        background-color: white;
        color: black;
        border: solid 1px;
        text-align: center;
        border-radius: 6px;
        padding: 5px 0;
        /* Position the tooltip */
        position: absolute;
        z-index: 1;
    }



    .infobycalendar-block {
        background-color: white;
    }
    
    
    .comain {
        padding-left: 0px;
        padding-right: 0px;
    } .coheader {
        
        min-height: 80px;
          background: linear-gradient(to right, #5ca4c2, #4674a3 98%) 0 0 no-repeat;
    }


    .coheader-links {
        padding-right: 50px;
    }
    .coheader-links h3{
        padding-top: 15px;
        padding-right: 30px;
        color: white;
        font-size: 14px;
        font-weight: 500;

    }
    .coinfo {
        min-height: 440px;
    }

    .pg-main {
        padding-top: 40px;
        min-height: 800px;
        background: url(../../img/pdrso-dots.png) 0px 0px no-repeat,linear-gradient(to right, #e55727 9%, #e21c25) 0 0 no-repeat;
        background: url(../../img/pdrso-dots.png) 0px 0px no-repeat,-webkit-linear-gradient(left, #e55727 9%, #e21c25) 0 0 no-repeat;
        background: url(../../img/pdrso-dots.png) 0px 0px no-repeat,-moz-linear-gradient(right, #e55727 9%, #e21c25) 0 0 no-repeat;
        background: url(../../img/pdrso-dots.png) 0px 0px no-repeat,-ms-linear-gradient(left, #e55727 9%, #e21c25) 0 0 no-repeat;
        background: url(../../img/pdrso-dots.png) 0px 0px no-repeat,-o-linear-gradient(right, #e55727 9%, #e21c25) 0 0 no-repeat;
        background: url(../../img/pdrso-dots.png) 0px 0px no-repeat,linear-gradient(to right, #e55727 9%, #e21c25) 0 0 no-repeat;
    }

    .info-blocks {
        padding-left: 0px;
        padding-right: 0px;
        min-height: 900px;
        
    }

    .one-info-block {
        padding-left: 0px;
        padding-right: 0px;
        background-color: white;
        height: 450px;

    }

    .one-info-block h2 {
        padding-top: 35%;
        padding-left: 10%;
        color: white;
        font-size: 20px;
        font-weight: bold;
    }

    .oib-links {
        
    }

    .oib-links h2{
        text-align: center;
        padding-top: 15%;
        font-size: 20px;
        font-weight: bold;
    }

        .oib-links ul {
            text-align: center;
        }

    .oib-links li{
        
    }
    
    .oib-studstarter {
        background-color:palevioletred;
    }
    .oib-studstarter h2 {
        text-align: center;
        } 
        
    .oib-co-members {
        background-color:slateblue;
    }

    .oib-co-members h2{
        text-align: center;
    }

    .oib-students {
        background-color: olive;
    }

        .oib-students h2 {
            padding-top: 15%;
            padding-left: 10%;
        }

    .oib-events {
        background-color: aqua;
    }
        .oib-events h2 {
            text-align: center;
        }



    .oib-prdso {
        background-color: cadetblue;
    }

        .oib-prdso h2 {
            text-align: center;
        }

    .links-block {
        min-height: 530px;
        background-color: lightpink;
    }

    .cal-filters {
        width: 80%;
        padding-left: 15px;
        padding-right: 15px;
        min-height: 450px;
        max-width: 395px;
        background-color: #fff;
        font-size: 100%;
        margin: 0 auto;
        
    }

    .active {
        background-color: rgb(229,111,52);
        color: white;
    }

    .detailsbutton{
        width:150px;
        text-align: center;
        position:center;
    }

    .pignose-calendar-top{
        border: none !important;
        box-shadow: none !important;
        background: none !important;
    }
    
    .pignose-calendar .pignose-calendar-unit.pignose-calendar-unit-active a {
        background-color: rgb(229,111,52);
        color: #ffffff !important;
        font-weight: 600;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
    }

    .pignose-calendar-button-schedule-pin {
        background-color: rgb(229,111,52) !important;
    }


    .pignose-calendar-week-sat {
        color: black !important;
    }

    .pignose-calendar-week-sun {
        color: black !important;
    }
    
    
    
    .pignose-calendar .pignose-calendar-unit a {
        color: black;
        font-weight: bold;
    }

    .pignose-calendar-unit-sat a {
        color: black !important;
    }

    .pignose-calendar-unit-sat a {
        color: black !important;
    }

    /*.pignose-calendar-unit.pignose-calendar-unit-active .pignose-calendar-unit-sat a {
        color: white;
    }*/
    
    
    .pignose-calendar-unit-sun a {
        color: black !important;
    }

    .eventdirection {
        box-shadow: none;
        border: none;
        margin-top: 7px;
        border-radius: 20px;
        font-weight: bold;
        font-size: 12px;
    }

</style>

<div class="comain col-md-12">
    <div class="coheader col-md-12">
        <div style="float: right;" class="coheader-links">
        <h3 style="display: inline-block"><a href="@Url.Action("Index","Profile")" style="color:white;">Заявка</a></h3>
        <h3 style="display: inline-block">Представитель СО</h3>
        <h3 style="display: inline-block">@Model.StudentCouncil.Name @Model.StudentCouncil.Surname</h3>

            <form asp-area="" asp-controller="Account" asp-action="Logout" method="post" style=" display: inline-block;">

                <button class="btn-red" style="margin-left:20px; margin-top:10px; padding-left: 20px; padding-right: 20px; padding-top: 3px; padding-bottom: 3px;" type="submit">ВЫЙТИ</button>
            </form>
        
        </div>

    </div>

    <div class="coinfo col-md-12">
        <div class="col-md-2"></div>
        <div class="col-md-2">
            <img src="~/img/raiting.jpg" alt="rating">
        </div>
        <div class="col-md-6" style="padding-top: 40px;">
            
            <p>@Model.StudentCouncil.UniversityData.UniversityName</p>
            <p>@Model.StudentCouncil.UniversityData.UniversityWebSite</p>
            <p>@Model.StudentCouncil.UniversityData.UniversityAddress</p> 
        </div>
        <div class="col-md-2"></div>
    </div>

    <div class="pg-main col-md-12">
        @*<div id="infobycalendar" class="col-md-2  infobycalendar-block"></div>*@
        <div class="col-md-12"style="padding-top:10%">
            <div class="col-md-2"></div>

            <div class="pgcalendar col-md-4" style="padding-left: 0px; padding-right: 0px; width:400px;"></div>
            <div class="cal-filters col-md-4" style="display:inline; word-wrap: break-word; width:400px;">
                <p style="font-family: 'Geometria','Open Sans','helvetica','sans-serif'; font-weight: bold; border:none; min-height:20px;padding-top: 30px; text-align:center;">Фильтр:</p>
                @foreach (var item in @Model.EventDirections)
            {
                    <input class="eventdirection form-control" type="button" data-directionid="@item.Id" value="@item.Name"/>
                }
            </div>
            <div class="col-md-2"></div>
        </div>
</div>

    <div class="info-blocks col-md-12">
        <div class=" oib-links col-md-6" style="text-align:center;">            
            @*<h2>Ссылки:</h2>
            <ul style="padding-left: 0pt;">
                <li>Ссылка один</li>
                <li>Ссылка два</li>
                <li>Ссылка три</li>
                <li>Ссылка четыре</li>
                <li>Ссылка пять</li>
            </ul>*@
        </div>
        <div class="one-info-block oib-studstarter col-md-3" style="background: url('/img/studstarter.jpg') no-repeat;background-size:cover; background-position: center center; -webkit-box-shadow: inset 10px 10px 300px -11px rgba(0,0,0,0.82);
-moz-box-shadow: inset 10px 10px 300px -11px rgba(0,0,0,0.82); box-shadow: inset 10px 10px 300px -11px rgba(0,0,0,0.82);">
            <h2>Студстартер</h2>
        </div>
        <a href="@Url.Action("Index","CoMembers")" class="one-info-block oib-co-members col-md-3" style="background: url('/img/sopeople.jpg') no-repeat;background-size:cover; background-position: center center; -webkit-box-shadow: inset 10px 10px 300px -11px rgba(0,0,0,0.82);
-moz-box-shadow: inset 10px 10px 300px -11px rgba(0,0,0,0.82); box-shadow: inset 10px 10px 300px -11px rgba(0,0,0,0.82);">
            <h2>Члены совета обучающихся</h2>
        </a>
        <a href="@Url.Action("Students","CO")" class="one-info-block oib-students col-md-6" style="background: url('/img/students.jpg') no-repeat;background-size:cover; background-position: center center; -webkit-box-shadow: inset 10px 10px 300px -11px rgba(0,0,0,0.82);
-moz-box-shadow: inset 10px 10px 300px -11px rgba(0,0,0,0.82); box-shadow: inset 10px 10px 300px -11px rgba(0,0,0,0.82);">
            <h2>Студенты</h2>
        </a>
        <div class="one-info-block oib-events col-md-3" style="background: url('/img/meropriyatia.jpg') no-repeat;background-size:cover; background-position: center center;-webkit-box-shadow: inset 10px 10px 300px -11px rgba(0,0,0,0.82);
-moz-box-shadow: inset 10px 10px 300px -11px rgba(0,0,0,0.82); box-shadow: inset 10px 10px 300px -11px rgba(0,0,0,0.82);">
            <h2>Мероприятия</h2>
        </div>
        <a href="@Url.Action("PrdsoEvents","CO")" class="one-info-block oib-prdso col-md-3" style="background: url('/img/onevent.jpg') no-repeat;background-size:cover; background-position: center center;-webkit-box-shadow: inset 10px 10px 300px -11px rgba(0,0,0,0.82);
-moz-box-shadow: inset 10px 10px 300px -11px rgba(0,0,0,0.82); box-shadow: inset 10px 10px 300px -11px rgba(0,0,0,0.82);">
            <h2>ПРДСО</h2>
        </a>
    </div>
    <div class="links-block col-md-12">
        <div class="col-md-3"></div>
        <div class="col-md-6">
            <h2>Документы самоуправления</h2>
            
            <ul>
                @foreach (var file in Model.Files)
                {
                    <li>@file.File.Name
                        <a href="@file.File.Path" download>
                            <i class="fa fa-download"></i>Скачать
                        </a>
                    </li>
                }
            </ul>
            <h3>Выберите файл для загрузки</h3>
            <form asp-action="AddFile" asp-controller="CO" method="post" enctype="multipart/form-data">
                <input type="file" name="uploadedFile" /><br>
                <input type="submit" value="Загрузить" />
            </form>
        </div>
        <div class="col-md-3"></div>
    </div>

</div>


<div class="dopinfa">

</div>

@section Scripts{
    <script src="~/pg-calendar-master/dist/js/pignose.calendar.full.js"></script>
    <script type="text/javascript">
        $(function() {

            var myArray = [];

            @foreach (var item in @Model.Events)
            {
                @:myArray.push({ eventid: @item.Id, name: "event", date: "@item.StartDateTime.ToString("yyyy-MM-dd")", startdatetime: "@item.StartDateTime.ToShortDateString()", stopdatetime: "@item.StopDateTime.ToShortDateString()", eventname: "@item.NameEvent" });
            }

            $('.pgcalendar').pignoseCalendar({
                lang: 'ru',
                week: 1,
                scheduleOptions: {
                    colors: {
                        event: '#2fabb7'
                    }
                },
                format: "DD.MM.YYYY",
                schedules: myArray,
                select: function (date, context) {
                    $(".infobycalendar").remove();
                    if (context.storage.schedules.length > 0) {
                        var messageAboutEvent = "";
                        messageAboutEvent += "<div class='infobycalendar'><p>Вы выбрали дату " + context.storage.schedules[0].date + "</p>";
                        for (var i = 0; i < context.storage.schedules.length; i++) {
                            messageAboutEvent += "<p>Название мероприятия " + context.storage.schedules[i].eventname + "</p>";
                            messageAboutEvent += "<p>Диапозон " + context.storage.schedules[i].startdatetime + "-" + context.storage.schedules[i].stopdatetime + "</p>";
                            messageAboutEvent += '<a id="eventDetails" href="/PublicEventsInfo/Details/' + context.storage.schedules[i].eventid + '" style="cursor:pointer;width: 150px;border-radius: 7%;">Подробнее</a>';
                        }
                        messageAboutEvent += "</div>";
                        $(this).append(messageAboutEvent);
                    }
                    updatelinktoEventDetails();
                }
            });

            var initcalendar = function(eventarray) {
                $('.pgcalendar').pignoseCalendar({
                    lang: 'ru',
                    week: 1,
                    scheduleOptions: {
                        colors: {
                            event: '#2fabb7'
                        }
                    },
                    format: "DD.MM.YYYY",
                    schedules: eventarray,
                    select: function(date, context) {
                        $(".infobycalendar").remove();
                        if (context.storage.schedules.length > 0) {
                            var messageAboutEvent = "";
                            messageAboutEvent += "<div class='infobycalendar'><p>Вы выбрали дату " + context.storage.schedules[0].date + "</p>";
                            for (var i = 0; i < context.storage.schedules.length; i++) {
                                messageAboutEvent += "<p>Название мероприятия " + context.storage.schedules[i].eventname + "</p>";
                                messageAboutEvent += "<p>Диапозон " + context.storage.schedules[i].startdatetime + "-" + context.storage.schedules[i].stopdatetime + "</p>";
                                messageAboutEvent += '<a id="eventDetails" href="/PublicEventsInfo/Details/' + context.storage.schedules[i].eventid + '" style="cursor:pointer;width: 150px;border-radius: 7%;">Подробнее</a>';
                            }
                            messageAboutEvent += "</div>";
                            $(this).append(messageAboutEvent);
                        }
                        updatelinktoEventDetails();
                    }
                });
            };

            var updatelinktoEventDetails = function () {
                $("#eventDetails").click(function () {
                    $(location).attr("href", $(this)[0].href);
                })
            }

            $(".eventdirection").click(function() {
                var hasClass = this.classList.contains('active');
                if (hasClass) {
                    this.classList.remove("active");;
                } else {
                    this.className += " active";
                }

                var directions = [];
                var activeFilterButtons = document.getElementsByClassName("eventdirection active");
                for (var i = 0; i < activeFilterButtons.length; i++) {
                    directions.push(activeFilterButtons[i].getAttribute('data-directionid'));
                }

                $.ajax({
                    method: "GET",
                    url: "@Url.Action("GetEventByFilter", "CO")",
                    data: { eventDirectionIds: directions },
                    datatype: "json",
                    traditional: true,
                }).success(function(res) {
                    initcalendar(res);
                }).error(function(res) {

                });
            });
        });
    </script>
}